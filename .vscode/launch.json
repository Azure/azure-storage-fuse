
{
    "configurations": [
        {
            "name": "Launch Blobfuse2",
            "type": "go",
            "request": "launch",
            "mode": "debug",
            "program": "${workspaceFolder}/main.go",
            // "environment": [
            //     {
            //         "name": "LD_LIBRARY_PATH",
            //         "value": "${LD_LIBRARY_PATH}:${workspaceFolder}:${workspaceFolder}/libtrouper",
            //     },
            // ],
            "args": [
                "mount",
                "/usr/blob_mnt",
                "--config-file=/home/vikas/go/src/azure-storage-fuse/config.yaml",
                "--foreground",
                //"--bench-path=./",
                // "--lazy-write",
                // "--log-type=silent",
                // "--block-cache-path=",
                // "--file-cache-timeout=120",
                // "--block-cache-block-size=2",
                // "--block-cache-pool-size=1024",
                // "--block-cache-path=./temp",
                // "--block-cache-disk-size=200",
                // "--block-cache-prefetch=13",
                // "--block-cache-prefetch-on-open=true",
                // "--file-cache-timeout-in-seconds=120",
                // "--use-attr-cache=true",
                // "--cancel-list-on-mount-seconds=10",
                // "--tmp-path=/mnt/blobfusetmp",
                // "--log-file-path=/home/vikas/go/src/azure-storage-fuse/blobfuse23.log",
                // "--log-type=base",
                // "-o allow_root",
                // "-d",
                // "-o direct_io",
                // "-o entry_timeout=120",
                // "-o negative_timeout=120",
                //"~/blob_mnt",
                //"$HOME/blob_mnt",
                // "--use-adls=true",
                // "--telemetry=APN/1.0 vibhansa/vikas.1.0 vibhansa/vikas.3.0",
                // "-o", "direct_io",
                // "--disable-compression=false",
                // "-d",
                // "--wait-for-mount=2",
                // "--streaming",
                // "--block-cache",
                // "-o", "uid=1002",
                // "-o", "gid=1002",
                // "--sync-to-flush",
                //"--default-working-dir=~/.abc",
                // "-o",
                // "allow_other",
                //"-o",
                //"nonempty,uid=1002,gid=1002",
                // "--ignore-open-flags",
                // "--container-name=testcnt1",
                // "--virtual-directory=false",
                // "--tmp-path=/mnt/blobfusetmp",
                // "--stream-create-file",
                //"--config-file=/home/vikas/.azfuse/config_temp.yaml.azsec",
                //"--secure-config=true",
                //"--passphrase=123123123123123123123123",
            ]
            
        },
        {
            "name": "Version check",
            "type": "go",
            "request": "launch",
            "mode": "debug",
            "go.buildFlags": [
                "-tags=fuse2",
            ],
            "go.testTags": "fuse2",
            "buildFlags": "-tags fuse2'",
            "program": "${workspaceFolder}/main.go",
            "environment": [
                {
                    "name": "LD_LIBRARY_PATH",
                    "value": "${LD_LIBRARY_PATH}:${workspaceFolder}:${workspaceFolder}/libtrouper",
                },
            ],
            "args": [
                "version",
                "--check",
            ]
            
        },
        {
            "name": "Launch Health-Monitor",
            "type": "go",
            "request": "launch",
            "mode": "debug",
            "go.buildFlags": [
                "-tags=fuse2",
            ],
            "go.testTags": "fuse2",
            "buildFlags": "-tags fuse2'",
            "program": "${workspaceFolder}/main.go",
            "environment": [
                {
                    "name": "LD_LIBRARY_PATH",
                    "value": "${LD_LIBRARY_PATH}:${workspaceFolder}:${workspaceFolder}/libtrouper",
                },
            ],
            "args": [
                "health-monitor",
                "--pid=12345",
                "--config-file=config.yaml",
            ]
        },
        {
            "name": "Launch MountV1",
            "type": "go",
            "request": "launch",
            "mode": "debug",
            "go.buildFlags": [
                "-tags=fuse2",
            ],
            "go.testTags": "fuse2",
            "buildFlags": "-tags fuse2'",
            "program": "${workspaceFolder}/main.go",
            "environment": [
                {
                    "name": "LD_LIBRARY_PATH",
                    "value": "${LD_LIBRARY_PATH}:${workspaceFolder}:${workspaceFolder}/libtrouper",
                },
            ],
            "args": [
                "mountv1",
                "/home/vikas/blob_mnt_go",
                "--tmp-path=/mnt/blobfusetmp",
                "--config-file=/home/vikas/myblob.cfg",
                //"-o allow_other",
                //"--log-level=LOG_DEBUG",
                //"--file-cache-timeout-in-seconds=30",
                //"--use-attr-cache=true",
                //"--cache-poll-timeout-msec=10000",
                //"--max-eviction=20",
                //"--cancel-list-on-mount-seconds=30",
            ]
            
        },
        {
            "name": "Blobfuse2 Coverage",
            "type": "go",
            "request": "launch",
            "mode": "test",
            "program": "${workspaceFolder}/azfuse.test",
            "args": [
                "-test.v",
                "-test.coverprofile=azfuse.out",
                "mount",
                "/home/vikas/blob_mnt_go",
                "--config-file=./config.yaml",
                //"--config-file=/home/vikas/.azfuse/config_testcnt1.yaml.azsec",
                //"--secure-config=true",
                //"--passphrase=123123123123123123123123",
            ]
        },
        {
            "name": "MountAll",
            "type": "go",
            "request": "launch",
            "mode": "debug",
            "go.buildFlags": [
                "-tags=fuse2",
            ],
            "go.testTags": "fuse2",
            "buildFlags": "-tags fuse2'",
            "program": "${workspaceFolder}/main.go",
            "envFile": "${workspaceFolder}/.vscode/.env",
            "args": [
                "mount",
                "all",
                "/usr/blob_mnt",
                "--allow-other",
                // "--tmp-path=/mnt/blobfusetmp",
                "--log-level=LOG_DEBUG",
                "--config-file=config.yaml",
                // "/home/vikas/blob_mnt_go",
                // "--config-file=/home/vikas/.azfuse/config_temp.yaml.azsec",
                // "--config-file=./config.yaml",
                // "--log-level=log_debug",
                // "--secure-config=true",
                // "--passphrase=123123123123123123123123",
            ]
        },
        {
            "name": "UnMountAll",
            "type": "go",
            "request": "launch",
            "mode": "debug",
            "program": "${workspaceFolder}/main.go",
            "go.buildFlags": [
                "-tags=fuse2",
            ],
            "go.testTags": "fuse2",
            "buildFlags": "-tags fuse2'",
            "args": [
                "unmount",
                "all",
                // "/usr*",
            ]
        },
        {
            "name": "Secure",
            "type": "go",
            "request": "launch",
            "mode": "debug",
            "program": "${workspaceFolder}/main.go",
            "args": [
                "secure",
                //"enc",
                "dec",
                //"get",
                //"set",
                //"--config-file=./config_temp.yaml",
                "--config-file=/home/vikas/.azfuse/config_temp.yaml.azsec",
                "--passphrase=123123123123123123123123",
                //"--key=logging.level",
                //"--key=azstorage.container",
                //"--value=log_info",
            ]
        },
        {
            "name": "Launch Storage test",
            "type": "go",
            "request": "launch",
            "mode": "test",
            "program": "${workspaceFolder}/component/file_cache",
            // "args": [
                // "-block-acct=vikasfuseblob",
                // "-adls-acct=vikasfusename",
                // "-block-cnt=testcnt1",
                // "-adls-cnt=testcnt",
                // "-block-key=nzS+/uDQquKMlsIERLtcrFDt8VD159GuGPQJQFFCQ0My/0J8rRknZQP7tpJXF04l9TBbkTwvgZW9aVHcsFtmDg==",
                // "-adls-key=X/8jryw0T/iLNsQsB1UAor7lZBm4cRrWFLiPSUeMeYCTcXtEB5j3riAqPT0zn8pEmReG7KcDoG6+41VU12YUHQ==",
                // "-block-sas=?sv=2019-12-12&ss=b&srt=sco&sp=rwdlacx&se=2022-11-23T20:29:30Z&st=2020-11-23T12:29:30Z&spr=https,http&sig=3XQaRRUHGFgDjVm7lX3ojwD7dxMTqpPUo4vhQWbKp%2BU%3D",
                // "-adls-sas=?sv=2020-02-10&ss=bfqt&srt=sco&sp=rwdlacupx&se=2025-03-10T19:39:52Z&st=2021-03-10T11:39:52Z&spr=https&sig=4U9zm%2FEbem0NNIpSxYegrHfs9m4DsPLOXPT%2FK9RYhc4%3D",
                // "-msi-app=1f1551d2-2db2-4d4d-a6f5-d7edbe75d98e",
                // "-msi-res=/subscriptions/ba45b233-e2ef-4169-8808-49eb0d8eba0d/resourceGroups/VikasFuseGrp/providers/Microsoft.ManagedIdentity/userAssignedIdentities/vikasfusetest_iden",
                // "-client=aca358bf-0baf-4cb8-ade2-76289b203cc4",
                // "-tenant=72f988bf-86f1-41af-91ab-2d7cd011db47",
                // "-secret=SEu6Od9ZK6jLF8t9r96Qa26O-~t5Z-nf~R",
                //"-zacct=devextest",
                //"-zcnt=testcnt1",
                //"-zkey='B6MQPlfXuFodxqTnaN9LqRpHq7ujonpgbfbb55J2/OEMfgF8q+Oa3/YZXb9moQ+BO3tveo7HMBayvqY3xb3l+Q== '",
                //"-zep='https://devextest.z19.storage.azure.net'"
            // ]
        },
        {
            "name": "Launch FeatureTest",
            "type": "go",
            "request": "launch",
            "mode": "test",
            "program": "${workspaceFolder}/test/feature_test/feature_test.go",
            "args": [
                "-mnt-path=/home/vikas/blob_mnt",
            ]
        },
        {
            "name": "Launch StressTest",
            "type": "go",
            "request": "launch",
            "mode": "test",
            "program": "-timeout 90m -p 1 -v ${workspaceFolder}/test/stress_test/stress_test.go -args -mnt-path=/home/vikas/blob_mnt",
            "args": [
                "-mnt-path=/home/vikas/blob_mnt",
            ]
        },
        {
            "name": "ATTACH-Blobfuse2",
            "type": "cppdbg",
            "request": "attach",
            "program": "${workspaceFolder}/blobfuse2",
            "processId": "${command:pickProcess}",
            "MIMode": "gdb",
            "setupCommands": [
                {
                    "description": "Enable pretty-printing for gdb",
                    "text": "-enable-pretty-printing",
                    "ignoreFailures": true
                },
                {
                    "description": "Follow fork mode child",
                    "text": "-gdb-set follow-fork-mode child",
                    "ignoreFailures": true
                }
            ]
        },
        {
            "name": "E2E Debug",
            "type": "go",
            "request": "launch",
            "mode": "test",
            "program": "${workspaceFolder}/test/e2e_tests/",
            "go.buildFlags": [
                "-tags=fuse2",
            ],
            "go.testTags": "fuse2",
            "buildFlags": "-tags fuse2'",
            "args": [
                "-test.v",
                "-test.timeout=7200s",
                "-test.run",
                "TestFileTestSuite/TestRenameSpecial",
                "-mnt-path=/usr/blob_mnt",
            ]
        },
        {
            "name": "UT Debug",
            "type": "go",
            "request": "launch",
            "mode": "test",
            "go.buildFlags": [
                "-tags=fuse2",
            ],
            "go.testTags": "fuse2",
            "buildFlags": "-tags fuse2'",
            "program": "${workspaceFolder}/component/block_cache",
            "args": [
                "-test.v",
                "-test.timeout=7200s",
                // "./...",
                "-test.run",
                "TestBlockCacheTestSuite/TestOpenMultiblockFile"
            ]
        },
        {
            "name": "ATTACH-blobfuse",
            "type": "cppdbg",
            "request": "attach",
            "program": "${workspaceFolder}/build/blobfuse",
            "processId": "${command:pickProcess}",
            "MIMode": "gdb",
            "setupCommands": [
                {
                    "description": "Enable pretty-printing for gdb",
                    "text": "-enable-pretty-printing",
                    "ignoreFailures": true
                },
                {
                    "description": "Follow fork mode child",
                    "text": "-gdb-set follow-fork-mode child",
                    "ignoreFailures": true
                }
            ]
        },
    ]
}
