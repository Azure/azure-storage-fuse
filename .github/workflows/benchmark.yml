name: Benchmark
on:
  schedule:
    - cron: '0 4 * * SUN'
  push:
    branches:
      - main

jobs:
  X86_PerfTesting:
    strategy:
      max-parallel: 1
      matrix:
        TestType: ["premium", "standard"]
        # TestType: ["premium", "standard", "premium_hns", "standard_hns"]
            
    runs-on: [self-hosted, 1ES.Pool=blobfuse2-benchmark]
    timeout-minutes: 360

    permissions:
      id-token: write
      contents: write
      pages: write
    
    steps:
      - uses: "./.github/template/perftesting"

  Arm64_PerfTesting:
    needs: X86_PerfTesting

    strategy:
      max-parallel: 1
      matrix:
        TestType: ["premium", "standard"]
        # TestType: ["premium", "standard", "premium_hns", "standard_hns"]
            
    runs-on: [self-hosted, 1ES.Pool=blobfuse2-benchmark-arm]
    timeout-minutes: 360

    permissions:
      id-token: write
      contents: write
      pages: write
    
    steps:
      - uses: "./.github/template/perftesting"

  